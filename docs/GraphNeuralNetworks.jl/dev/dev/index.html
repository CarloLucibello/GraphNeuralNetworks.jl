<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/GraphNeuralNetworks.jl/'</script><script charset="utf-8" src="../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Developer guide · GraphNeuralNetworks.jl</title><meta content="Developer guide · GraphNeuralNetworks.jl" name="title"/><meta content="Developer guide · GraphNeuralNetworks.jl" property="og:title"/><meta content="Developer guide · GraphNeuralNetworks.jl" property="twitter:title"/><meta content="Documentation for GraphNeuralNetworks.jl." name="description"/><meta content="Documentation for GraphNeuralNetworks.jl." property="og:description"/><meta content="Documentation for GraphNeuralNetworks.jl." property="twitter:description"/><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../../.."><img alt="home" src="../../../../logo.svg"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link active nav-item" href="../../">GraphNeuralNetworks.jl</a><a class="nav-link nav-item" href="../../../GNNLux.jl/">GNNLux.jl</a><a class="nav-link nav-item" href="../../../GNNGraphs.jl/">GNNGraphs.jl</a><a class="nav-link nav-item" href="../../../GNNlib.jl/">GNNlib.jl</a><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img alt="GraphNeuralNetworks.jl logo" src="../assets/logo.svg"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GraphNeuralNetworks.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="../GNNGraphs/guides/gnngraph/">Graphs</a></li><li><a class="tocitem" href="../GNNlib/guides/messagepassing/">Message Passing</a></li><li><a class="tocitem" href="../guides/models/">Models</a></li><li><a class="tocitem" href="../GNNGraphs/guides/datasets/">Datasets</a></li><li><a class="tocitem" href="../GNNGraphs/guides/heterograph/">Heterogeneous Graphs</a></li><li><a class="tocitem" href="../GNNGraphs/guides/temporalgraph/">Temporal Graphs</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Introductory tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/gnn_intro_pluto/">Hands on</a></li><li><a class="tocitem" href="../tutorials/node_classification_pluto/">Node classification</a></li><li><a class="tocitem" href="../tutorials/graph_classification_pluto/">Graph classification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Temporal graph neural networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/traffic_prediction/">Node autoregression</a></li><li><a class="tocitem" href="../tutorials/temporal_graph_classification_pluto/">Temporal graph classification</a></li></ul></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Graphs (GNNGraphs.jl)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNNGraphs/api/gnngraph/">GNNGraph</a></li><li><a class="tocitem" href="../GNNGraphs/api/heterograph/">GNNHeteroGraph</a></li><li><a class="tocitem" href="../GNNGraphs/api/temporalgraph/">TemporalSnapshotsGNNGraph</a></li><li><a class="tocitem" href="../GNNGraphs/api/samplers/">Samplers</a></li><li><a class="tocitem" href="../GNNGraphs/api/datasets/">Datasets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Message Passing (GNNlib.jl)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNNlib/api/messagepassing/">Message Passing</a></li><li><a class="tocitem" href="../GNNlib/api/utils/">Other Operators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Layers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/basic/">Basic layers</a></li><li><a class="tocitem" href="../api/conv/">Convolutional layers</a></li><li><a class="tocitem" href="../api/pool/">Pooling layers</a></li><li><a class="tocitem" href="../api/temporalconv/">Temporal Convolutional layers</a></li><li><a class="tocitem" href="../api/heteroconv/">Hetero Convolutional layers</a></li></ul></li></ul></li><li class="is-active"><a class="tocitem" href="">Developer guide</a><ul class="internal"><li><a class="tocitem" href="#Development-Enviroment"><span>Development Enviroment</span></a></li><li><a class="tocitem" href="#Add-a-New-Layer"><span>Add a New Layer</span></a></li><li><a class="tocitem" href="#Versions-and-Tagging"><span>Versions and Tagging</span></a></li><li><a class="tocitem" href="#Generate-Documentation-Locally"><span>Generate Documentation Locally</span></a></li><li><a class="tocitem" href="#Benchmarking"><span>Benchmarking</span></a></li><li><a class="tocitem" href="#Caching-tutorials"><span>Caching tutorials</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">Developer guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Developer guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl/blob/master/GraphNeuralNetworks/docs/src/dev.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Developer-Notes"><a class="docs-heading-anchor" href="#Developer-Notes">Developer Notes</a><a id="Developer-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Developer-Notes" title="Permalink"></a></h1><h2 id="Development-Enviroment"><a class="docs-heading-anchor" href="#Development-Enviroment">Development Enviroment</a><a id="Development-Enviroment-1"></a><a class="docs-heading-anchor-permalink" href="#Development-Enviroment" title="Permalink"></a></h2><p>GraphNeuralNetworks.jl is package hosted in a monorepo that contains multiple packages.  The GraphNeuralNetworks.jl package depends on GNNGraphs.jl and GNNlib.jl, also hosted in the same monorepo. In order </p><pre><code class="language-julia hljs">pkg&gt; activate .

pkg&gt; dev ./GNNGraphs</code></pre><h2 id="Add-a-New-Layer"><a class="docs-heading-anchor" href="#Add-a-New-Layer">Add a New Layer</a><a id="Add-a-New-Layer-1"></a><a class="docs-heading-anchor-permalink" href="#Add-a-New-Layer" title="Permalink"></a></h2><p>To add a new graph convolutional layer and make it available in both the Flux-based frontend (GraphNeuralNetworks.jl) and the Lux-based frontend (GNNLux), you need to:</p><ol><li>Add the functional version to GNNlib</li><li>Add the stateful version to GraphNeuralNetworks</li><li>Add the stateless version to GNNLux</li><li>Add the layer to the table in docs/api/conv.md</li></ol><p>We suggest to start with implementing a self-contained Flux layer in GraphNeuralNetworks.jl, add the corresponding tests, and then when everything is working, move the implementation of the forward pass to GNNlib.jl. At this point, you can add the stateless version to GNNLux.jl.</p><p>It could also be convenient to use the <code>@structdef</code> macro from <a href="https://github.com/CarloLucibello/AutoStructs.jl">Autostruct.jl</a> to simultaneously generate the struct and the constructor for the layer. For example, the Flux implementation of <a href="../api/conv/#GraphNeuralNetworks.MEGNetConv"><code>MEGNetConv</code></a> layer can be written as follows:</p><pre><code class="language-julia hljs">using Flux, GraphNeuralNetworks, AutoStructs

@structdef function MEGNetConv(ch::Pair{Int, Int}; aggr = mean)
    nin, nout = ch
    ϕe = Chain(Dense(3nin, nout, relu),
               Dense(nout, nout))

    ϕv = Chain(Dense(nin + nout, nout, relu),
               Dense(nout, nout))

    return MEGNetConv(ϕe, ϕv, aggr)
end

Flux.@layer MEGNetConv

function (l::MEGNetConv)(g::AbstractGraph, x::AbstractMatrix, e::AbstractMatrix)
    ē = apply_edges(g, xi = x, xj = x, e = e) do xi, xj, e
        l.ϕe(vcat(xi, xj, e))
    end
    xᵉ = aggregate_neighbors(g, l.aggr, ē)
    x̄ = l.ϕv(vcat(x, xᵉ))
    return x̄, ē
end</code></pre><h2 id="Versions-and-Tagging"><a class="docs-heading-anchor" href="#Versions-and-Tagging">Versions and Tagging</a><a id="Versions-and-Tagging-1"></a><a class="docs-heading-anchor-permalink" href="#Versions-and-Tagging" title="Permalink"></a></h2><p>Each PR should update the version number in the Porject.toml file of each involved package if needed by semnatic versioning. For instance, when adding new features GNNGraphs could move from "1.17.5" to "1.18.0-DEV". The "DEV" will be removed when the package is tagged and released. Pay also attention to updating the compat bounds, e.g. GraphNeuralNetworks might require a newer version of GNNGraphs.</p><h2 id="Generate-Documentation-Locally"><a class="docs-heading-anchor" href="#Generate-Documentation-Locally">Generate Documentation Locally</a><a id="Generate-Documentation-Locally-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Documentation-Locally" title="Permalink"></a></h2><p>For generating the documentation locally</p><pre><code class="nohighlight hljs">cd docs
julia</code></pre><pre><code class="language-julia hljs">(@v1.10) pkg&gt; activate .
  Activating project at `~/.julia/dev/GraphNeuralNetworks/docs`

(docs) pkg&gt; dev ../ ../GNNGraphs/
   Resolving package versions...
  No Changes to `~/.julia/dev/GraphNeuralNetworks/docs/Project.toml`
  No Changes to `~/.julia/dev/GraphNeuralNetworks/docs/Manifest.toml`

julia&gt; include("make.jl")</code></pre><h2 id="Benchmarking"><a class="docs-heading-anchor" href="#Benchmarking">Benchmarking</a><a id="Benchmarking-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmarking" title="Permalink"></a></h2><p>You can benchmark the effect on performance of your commits using the script <code>perf/perf.jl</code>.</p><p>First, checkout and benchmark the master branch:</p><pre><code class="language-julia hljs">julia&gt; include("perf.jl")

julia&gt; df = run_benchmarks()

# observe results
julia&gt; for g in groupby(df, :layer); println(g, "\n"); end

julia&gt; @save "perf_master_20210803_mymachine.jld2" dfmaster=df</code></pre><p>Now checkout your branch and do the same:</p><pre><code class="language-julia hljs">julia&gt; df = run_benchmarks()

julia&gt; @save "perf_pr_20210803_mymachine.jld2" dfpr=df</code></pre><p>Finally, compare the results:</p><pre><code class="language-julia hljs">julia&gt; @load "perf_master_20210803_mymachine.jld2"

julia&gt; @load "perf_pr_20210803_mymachine.jld2"

julia&gt; compare(dfpr, dfmaster)</code></pre><h2 id="Caching-tutorials"><a class="docs-heading-anchor" href="#Caching-tutorials">Caching tutorials</a><a id="Caching-tutorials-1"></a><a class="docs-heading-anchor-permalink" href="#Caching-tutorials" title="Permalink"></a></h2><p>Tutorials in GraphNeuralNetworks.jl are written in Pluto and rendered using <a href="https://github.com/JuliaDocs/DemoCards.jl">DemoCards.jl</a> and <a href="https://github.com/rikhuijzer/PlutoStaticHTML.jl">PlutoStaticHTML.jl</a>. Rendering a Pluto notebook is time and resource-consuming, especially in a CI environment. So we use the <a href="https://huijzer.xyz/PlutoStaticHTML.jl/dev/#Caching">caching functionality</a> provided by PlutoStaticHTML.jl to reduce CI time.</p><p>If you are contributing a new tutorial or making changes to the existing notebook, generate the docs locally before committing/pushing. For caching to work, the cache environment(your local) and the documenter CI should have the same Julia version (e.g. "v1.9.1", also the patch number must match). So use the <a href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl/blob/master/.github/workflows/docs.yml#L17">documenter CI Julia version</a> for generating docs locally.</p><pre><code class="language-console hljs">julia --version # check julia version before generating docs
julia --project=docs docs/make.jl</code></pre><p>Note: Use <a href="https://github.com/JuliaLang/juliaup">juliaup</a> for easy switching of Julia versions.</p><p>During the doc generation process, DemoCards.jl stores the cache notebooks in docs/pluto_output. So add any changes made in this folder in your git commit. Remember that every file in this folder is machine-generated and should not be edited manually.</p><pre><code class="nohighlight hljs">git add docs/pluto_output # add generated cache</code></pre><p>Check the <a href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl/actions/workflows/docs.yml">documenter CI logs</a> to ensure that it used the local cache:</p><p><img alt="" src="https://user-images.githubusercontent.com/55111154/210061301-c84b7274-9e66-46fd-b272-d45b1c681d00.png"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/heteroconv/">« Hetero Convolutional layers</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 17 December 2024 11:24">Tuesday 17 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>