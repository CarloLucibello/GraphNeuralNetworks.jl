<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Models · GNNLux.jl</title><meta name="title" content="Models · GNNLux.jl"/><meta property="og:title" content="Models · GNNLux.jl"/><meta property="twitter:title" content="Models · GNNLux.jl"/><meta name="description" content="Documentation for GNNLux.jl."/><meta property="og:description" content="Documentation for GNNLux.jl."/><meta property="twitter:description" content="Documentation for GNNLux.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GNNLux.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="../../GNNGraphs/guides/gnngraph/">Graphs</a></li><li><a class="tocitem" href="../../GNNlib/guides/messagepassing/">Message Passing</a></li><li class="is-active"><a class="tocitem" href>Models</a><ul class="internal"><li><a class="tocitem" href="#Explicit-modeling"><span>Explicit modeling</span></a></li><li><a class="tocitem" href="#Implicit-modeling-with-GNNChains"><span>Implicit modeling with GNNChains</span></a></li></ul></li><li><a class="tocitem" href="../../GNNGraphs/guides/datasets/">Datasets</a></li><li><a class="tocitem" href="../../GNNGraphs/guides/heterograph/">Heterogeneous Graphs</a></li><li><a class="tocitem" href="../../GNNGraphs/guides/temporalgraph/">Temporal Graphs</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Introductory tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/gnn_intro/">Hands on</a></li></ul></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Graphs (GNNGraphs.jl)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GNNGraphs/api/gnngraph/">GNNGraph</a></li><li><a class="tocitem" href="../../GNNGraphs/api/heterograph/">GNNHeteroGraph</a></li><li><a class="tocitem" href="../../GNNGraphs/api/temporalgraph/">TemporalSnapshotsGNNGraph</a></li><li><a class="tocitem" href="../../GNNGraphs/api/samplers/">Samplers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Message Passing (GNNlib.jl)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GNNlib/api/messagepassing/">Message Passing</a></li><li><a class="tocitem" href="../../GNNlib/api/utils/">Other Operators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Layers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/basic/">Basic layers</a></li><li><a class="tocitem" href="../../api/conv/">Convolutional layers</a></li><li><a class="tocitem" href="../../api/temporalconv/">Temporal Convolutional layers</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guides</a></li><li class="is-active"><a href>Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGraphs/GraphNeuralNetworks.jl/blob/master/GNNLux/docs/src/guides/models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h1><p>GNNLux.jl provides common graph convolutional layers by which you can assemble arbitrarily deep or complex models. GNN layers are compatible with  Lux.jl ones, therefore expert Lux users are promptly able to define and train  their models. </p><p>In what follows, we discuss two different styles for model creation: the <em>explicit modeling</em> style, more verbose but more flexible,  and the <em>implicit modeling</em> style based on <a href="../../api/basic/#GNNLux.GNNChain"><code>GNNLux.GNNChain</code></a>, more concise but less flexible.</p><h2 id="Explicit-modeling"><a class="docs-heading-anchor" href="#Explicit-modeling">Explicit modeling</a><a id="Explicit-modeling-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-modeling" title="Permalink"></a></h2><p>In the explicit modeling style, the model is created according to the following steps:</p><ol><li>Define a new type for your model (<code>GNN</code> in the example below). Refer to the</li></ol><p><a href="https://lux.csail.mit.edu/dev/manual/interface#lux-interface">Lux Manual</a> for the  definition of the type.</p><ol><li>Define a convenience constructor for your model.</li><li>Define the forward pass by implementing the call method for your type.</li><li>Instantiate the model. </li></ol><p>Here is an example of this construction:</p><pre><code class="language-julia hljs">using Lux, GNNLux
using Zygote
using Random, Statistics

struct GNN &lt;: AbstractLuxContainerLayer{(:conv1, :bn, :conv2, :dropout, :dense)} # step 1
    conv1
    bn
    conv2
    dropout
    dense
end

function GNN(din::Int, d::Int, dout::Int) # step 2
    GNN(GraphConv(din =&gt; d),
        BatchNorm(d),
        GraphConv(d =&gt; d, relu),
        Dropout(0.5),
        Dense(d, dout))
end

function (model::GNN)(g::GNNGraph, x, ps, st) # step 3
    x, st_conv1 = model.conv1(g, x, ps.conv1, st.conv1)
    x, st_bn = model.bn(x, ps.bn, st.bn)
    x = relu.(x)
    x, st_conv2 = model.conv2(g, x, ps.conv2, st.conv2)
    x, st_drop = model.dropout(x, ps.dropout, st.dropout)
    x, st_dense = model.dense(x, ps.dense, st.dense)
    return x, (conv1=st_conv1, bn=st_bn, conv2=st_conv2, dropout=st_drop, dense=st_dense)
end

din, d, dout = 3, 4, 2 
model = GNN(din, d, dout)                 # step 4
rng = Random.default_rng()
ps, st = Lux.setup(rng, model)
g = rand_graph(rng, 10, 30)
X = randn(Float32, din, 10) 

st = Lux.testmode(st)
y, st = model(g, X, ps, st) 
st = Lux.trainmode(st)
grad = Zygote.gradient(ps -&gt; mean(model(g, X, ps, st)[1]), ps)[1]</code></pre><h2 id="Implicit-modeling-with-GNNChains"><a class="docs-heading-anchor" href="#Implicit-modeling-with-GNNChains">Implicit modeling with GNNChains</a><a id="Implicit-modeling-with-GNNChains-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-modeling-with-GNNChains" title="Permalink"></a></h2><p>While very flexible, the way in which we defined <code>GNN</code> model definition in last section is a bit verbose. In order to simplify things, we provide the <a href="../../api/basic/#GNNLux.GNNChain"><code>GNNLux.GNNChain</code></a> type. It is very similar  to Lux&#39;s well known <code>Chain</code>. It allows to compose layers in a sequential fashion as Chain does, propagating the output of each layer to the next one. In addition, <code>GNNChain</code>   propagates the input graph as well, providing it as a first argument to layers subtyping the <a href="../../api/basic/#GNNLux.GNNLayer"><code>GNNLux.GNNLayer</code></a> abstract type. </p><p>Using <code>GNNChain</code>, the model definition becomes more concise:</p><pre><code class="language-julia hljs">model = GNNChain(GraphConv(din =&gt; d),
                 BatchNorm(d),
                 x -&gt; relu.(x),
                 GraphConv(d =&gt; d, relu),
                 Dropout(0.5),
                 Dense(d, dout))</code></pre><p>The <code>GNNChain</code> only propagates the graph and the node features. More complex scenarios, e.g. when also edge features are updated, have to be handled using the explicit definition of the forward pass. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../GNNlib/guides/messagepassing/">« Message Passing</a><a class="docs-footer-nextpage" href="../../GNNGraphs/guides/datasets/">Datasets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Saturday 7 December 2024 08:45">Saturday 7 December 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
